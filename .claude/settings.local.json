{
  "permissions": {
    "allow": [
      "Bash(curl -I http://localhost:3000/mobile)",
      "Bash(lsof -ti:3000)",
      "Bash(npm run dev)",
      "Bash(curl -s -o /dev/null -w \"HTTP Status: %{http_code}\\n\" http://localhost:3000/mobile)",
      "Bash(source venv_linux/bin/activate)",
      "Bash(python -m pytest src/ tests/ -q --tb=no)",
      "Bash(uv run pytest src/ tests/ -q --tb=no)",
      "Bash(git mv proxy_agent_platform/ references/legacy/)",
      "Bash(.venv/bin/python -m pytest src/api/tests/test_task_splitting_api.py -v --tb=short)",
      "Bash(git rm -r agent/)",
      "Bash(git log --oneline --all --grep=\"epic\" -i)",
      "Bash(git rm -r mcp_servers/)",
      "Bash(git commit -m \"$(cat <<''EOF''\nrefactor: archive legacy code and remove obsolete directories (Week 1 cleanup)\n\nMajor directory reorganization following DIRECTORY_CLEANUP_REPORT.md:\n\n**Archived legacy code (2.7MB)**:\n- proxy_agent_platform/ → references/legacy/proxy_agent_platform/\n  * Legacy agents, API endpoints, workflows (replaced by src/)\n  * All Epic 2 development happened in src/, not this legacy code\n  * 80% functionality overlap with modern src/ directory\n  * Preserved for reference, not active development\n\n**Deleted obsolete directories**:\n- agent/ (132KB) - Abandoned FastAPI prototype, replaced by src/api/\n- mcp_servers/ - Context engineering MCP server moved to use-cases\n\n**Import Status**:\n- 29 files still reference legacy proxy_agent_platform (mostly in tests/)\n- These are legacy tests that will be migrated/deleted in Week 2\n- New code in src/ does not import from archived code\n\n**Next Steps (Week 2)**:\n- Migrate/delete tests importing from legacy code\n- Follow vertical slice architecture per CLAUDE.md\n- Move active tests to src/*/tests/ pattern\n\nSee DIRECTORY_CLEANUP_REPORT.md for complete 3-week migration plan.\nEOF\n)\")",
      "Bash(.venv/bin/python -m pytest src/api/tests/test_task_splitting_api.py::TestSplitTaskEndpoint::test_split_multi_scope_task_success -vv --tb=long)",
      "Bash(.venv/bin/python -m pytest src/api/tests/test_task_splitting_api.py -v --tb=line)",
      "Bash(.venv/bin/python -m pytest src/api/tests/test_task_splitting_api.py::TestSplitTaskEndpoint::test_split_multi_scope_task_success -vv --tb=short)",
      "Bash(.venv/bin/python -m pytest src/api/tests/test_task_splitting_api.py::TestADHDOptimizedFeatures::test_micro_steps_have_delegation_suggestions -vv --tb=short)",
      "Bash(echo \"✅ Solarized Dark Theme - Complete Fix Applied\n\n## Fixed Components:\n✓ Gauge Component - Light text on dark background\n✓ Chip Component - Proper border and background\n✓ Card Component - Dark cards with light text\n✓ Pill Component - Color-coded with Solarized palette\n✓ TaskRow Component - All text and buttons themed\n✓ Pomodoro Component - Timer and buttons themed\n✓ AgentStatus Component - Dark background with light text  \n✓ TimelineItem Component - All text colors fixed\n✓ AnalysisPreview Component - Gradient background with themed colors\n✓ ClarityForm Component - Inputs, buttons, all themed\n✓ QuickCapture Component - Inputs and buttons themed\n✓ DoWithMe Component - Buttons themed\n✓ All Main Content Cards - Text and backgrounds fixed\n✓ Progress Bar - Solarized colors\n✓ Mobile Navigation - Bottom bar themed\n\n## Theme Verification:\n\")",
      "Bash(.venv/bin/python -m pytest src/api/tests/test_task_splitting_api.py -v)",
      "Bash(git add src/agents/split_proxy_agent.py src/api/tasks.py src/api/tests/test_task_splitting_api.py src/services/task_service.py)",
      "Bash(git commit -m \"$(cat <<''EOF''\nfeat(epic-7): implement API endpoints for task splitting with AI (Phase 7.1 - T7.1.4)\n\nFollowing Outside-In TDD (RED-GREEN-REFACTOR):\n- RED: Wrote 16 API endpoint tests first (test_task_splitting_api.py)\n- GREEN: Implemented all endpoints to pass tests\n- Result: 16/16 tests passing (100%)\n\nAPI Endpoints Implemented:\n- POST /api/v1/tasks/{task_id}/split\n  * Integrates Split Proxy Agent with AI (OpenAI/Anthropic)\n  * Generates ADHD-optimized micro-steps (2-5 min each)\n  * Returns immediate next_action for quick win\n  * Handles SIMPLE/MULTI/PROJECT scopes differently\n  * Caches micro-steps in database\n\n- GET /api/v1/tasks/{task_id}\n  * Extended to include micro_steps array\n  * Queries micro_steps table and joins with task\n\n- PATCH /api/v1/micro-steps/{step_id}/complete\n  * Marks step as completed with actual_minutes\n  * Awards XP (dopamine hit from HABIT.md psychology)\n  * Base: 10 XP, Bonus: +5 if faster than estimated\n\n- GET /api/v1/tasks/{task_id}/progress\n  * Calculates progress_percentage from completed steps\n  * Shows completed_steps / total_steps ratio\n\nTest Infrastructure:\n- Fixed SQLite threading issues (check_same_thread=False)\n- Used FastAPI dependency injection for test database\n- Removed monkeypatch approach (cleaner DI pattern)\n\nIntegration:\n- Split Proxy Agent uses AI to break tasks intelligently\n- Fallback to rule-based splitting when AI unavailable\n- Database persistence for micro-steps\n- ADHD psychology: quick wins, clear delegation, progress tracking\n\nFollows CLAUDE.md standards:\n- Outside-In TDD (API tests → implementation)\n- All tests in src/api/tests/ next to endpoints\n- Type hints throughout\n- Google-style docstrings\n- 16/16 tests passing\n\nNext: Frontend integration for mobile ADHD task splitting UI\nEOF\n)\")",
      "Bash(.venv/bin/python -m pytest src/ -v --tb=no -q)",
      "Bash(.venv/bin/python -m pytest src/api/tests/test_task_splitting_api.py src/core/tests/test_task_splitting_models.py src/database/tests/test_epic7_migration.py -v --tb=no)",
      "Bash(npx tsc --noEmit)",
      "Bash(git rm -r tests/gamification/ tests/learning/ tests/models/)",
      "Bash(git rm tests/test_learning_optimization.py tests/test_agent_integration.py tests/test_git_integration.py tests/test_epic_3_4_integration.py tests/test_task_agent.py tests/test_performance_benchmarks.py tests/test_security.py tests/test_dashboard_api.py tests/test_workflow_system.py tests/test_mobile_integration.py)",
      "Bash(git rm -r tests/mobile/)"
    ],
    "deny": [],
    "ask": []
  }
}
