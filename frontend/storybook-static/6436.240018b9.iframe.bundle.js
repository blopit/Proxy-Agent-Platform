"use strict";(self.webpackChunkproxy_agent_platform_frontend=self.webpackChunkproxy_agent_platform_frontend||[]).push([[6436],{"./node_modules/.pnpm/lucide-react@0.292.0_react@18.3.1/node_modules/lucide-react/dist/esm/createLucideIcon.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>createLucideIcon});var react=__webpack_require__("./node_modules/.pnpm/next@15.5.6_@babel+core@7.28.4_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/compiled/react/index.js"),defaultAttributes={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const createLucideIcon=(iconName,iconNode)=>{const Component=(0,react.forwardRef)(({color="currentColor",size=24,strokeWidth=2,absoluteStrokeWidth,children,...rest},ref)=>{return(0,react.createElement)("svg",{ref,...defaultAttributes,width:size,height:size,stroke:color,strokeWidth:absoluteStrokeWidth?24*Number(strokeWidth)/Number(size):strokeWidth,className:`lucide lucide-${string=iconName,string.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,...rest},[...iconNode.map(([tag,attrs])=>(0,react.createElement)(tag,attrs)),...(Array.isArray(children)?children:[children])||[]]);var string});return Component.displayName=`${iconName}`,Component}},"./node_modules/.pnpm/lucide-react@0.292.0_react@18.3.1/node_modules/lucide-react/dist/esm/icons/x.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>X});const X=(0,__webpack_require__("./node_modules/.pnpm/lucide-react@0.292.0_react@18.3.1/node_modules/lucide-react/dist/esm/createLucideIcon.js").A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},"./src/components/shared/AsyncJobTimeline.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/next@15.5.6_@babel+core@7.28.4_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/compiled/react/jsx-runtime.js"),styled_jsx_style__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/.pnpm/styled-jsx@5.1.7_@babel+core@7.28.4_react@18.3.1/node_modules/styled-jsx/style.js"),styled_jsx_style__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(styled_jsx_style__WEBPACK_IMPORTED_MODULE_1__),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/.pnpm/next@15.5.6_@babel+core@7.28.4_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/compiled/react/index.js"),_barrel_optimize_names_X_lucide_react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/.pnpm/lucide-react@0.292.0_react@18.3.1/node_modules/lucide-react/dist/esm/icons/x.js"),_ProgressBar__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/components/shared/ProgressBar.tsx"),_components_mobile_core_ChevronStep__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/components/mobile/core/ChevronStep.tsx"),_OpenMoji__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./src/components/shared/OpenMoji.tsx"),_lib_design_system__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./src/lib/design-system.ts"),_hooks_useReducedMotion__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./src/hooks/useReducedMotion.ts"),console=__webpack_require__("./node_modules/.pnpm/console-browserify@1.2.0/node_modules/console-browserify/index.js");function StepSection({step,index,totalSteps,isExpanded,size,tab,onClick,stepProgressPercent,onRetry,effectiveExpandedId,loadingChildren,hasNestedContent,activeProgress,activeProgressPulse=!0}){(0,_hooks_useReducedMotion__WEBPACK_IMPORTED_MODULE_8__.I)();const textColors={pending:_lib_design_system__WEBPACK_IMPORTED_MODULE_7__.ZI.text.secondary,active:_lib_design_system__WEBPACK_IMPORTED_MODULE_7__.Tj.blue,done:_lib_design_system__WEBPACK_IMPORTED_MODULE_7__.Tj.green,error:_lib_design_system__WEBPACK_IMPORTED_MODULE_7__.Tj.red,next:_lib_design_system__WEBPACK_IMPORTED_MODULE_7__.Tj.orange},getEmoji=()=>step.icon?step.icon:"DIGITAL"===step.leafType?"ðŸ¤–":"HUMAN"===step.leafType?"ðŸ‘¤":"ðŸ“‹",getChevronPosition=()=>{const isFirst=0===index,isLast=index===totalSteps-1;return isFirst&&isLast?"single":isFirst?"first":isLast?"last":"middle"},isBaseState=null===effectiveExpandedId,isAccordionCollapsed=null!==effectiveExpandedId&&!isExpanded;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"relative",style:{flex:isBaseState||isExpanded?"1 1 0%":"0 0 40px",minWidth:isBaseState||isExpanded?0:"40px",maxWidth:isBaseState||isExpanded?"100%":"40px",overflow:"visible",marginRight:index!==totalSteps-1?"-2px":"0"},children:["active"===step.status&&void 0!==activeProgress&&activeProgress>0&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:activeProgressPulse?"active-progress-overlay":"",style:{position:"absolute",inset:0,width:`${activeProgress}%`,background:"linear-gradient(90deg, rgba(255, 255, 255, 0.25), rgba(210, 240, 255, 0.35) 30%, rgba(255, 255, 255, 0.45) 50%, rgba(210, 240, 255, 0.35) 70%, rgba(255, 255, 255, 0.25))",backgroundSize:"200% 100%",pointerEvents:"none",overflow:"hidden",zIndex:10,clipPath:(pos=getChevronPosition(),"single"===pos?"none":"first"===pos?"polygon(\n        0 0,\n        100% 0,\n        100% 100%,\n        0 100%\n      )":"middle"===pos?"polygon(\n        0 0,\n        100% 0,\n        100% 100%,\n        0 100%,\n        10px 50%\n      )":"polygon(\n      0 0,\n      100% 0,\n      100% 100%,\n      0 100%,\n      10px 50%\n    )"),display:"flex",alignItems:"center",paddingLeft:"16px"},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("span",{style:{fontSize:"0.75rem",fontWeight:700,color:"rgba(0, 0, 0, 0.6)",textShadow:"0 1px 0 rgba(255, 255, 255, 0.9), 0 -1px 0 rgba(0, 0, 0, 0.15)",letterSpacing:"0.5px"},children:[Math.round(activeProgress),"%"]})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_components_mobile_core_ChevronStep__WEBPACK_IMPORTED_MODULE_5__.A,{status:step.status,position:getChevronPosition(),size,onClick,isExpanded,width:isBaseState||isExpanded?"100%":"40px",children:[isAccordionCollapsed?"active"===step.status?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{style:{position:"relative",width:"100%",height:"100%"},children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"emoji-blend-black",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_OpenMoji__WEBPACK_IMPORTED_MODULE_6__.A,{emoji:getEmoji(),size:"nano"===size?18:24,variant:"black",engraved:!0})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"emoji-blend-color",style:{position:"absolute",inset:0},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_OpenMoji__WEBPACK_IMPORTED_MODULE_6__.A,{emoji:getEmoji(),size:"nano"===size?18:24,variant:"color",embossed:!0})})]}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_OpenMoji__WEBPACK_IMPORTED_MODULE_6__.A,{emoji:getEmoji(),size:"nano"===size?18:24,variant:"done"===step.status||"error"===step.status?"color":"black",engraved:"done"!==step.status&&"error"!==step.status,embossed:"done"===step.status||"error"===step.status}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"nano"===size?"4px":"micro"===size?"6px":"8px",flexWrap:"nowrap"},children:["active"===step.status?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{style:{position:"relative",flexShrink:0},children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"emoji-blend-black",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_OpenMoji__WEBPACK_IMPORTED_MODULE_6__.A,{emoji:getEmoji(),size:"nano"===size?16:"micro"===size?24:20,variant:"black",embossed:!0})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"emoji-blend-color",style:{position:"absolute",inset:0},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_OpenMoji__WEBPACK_IMPORTED_MODULE_6__.A,{emoji:getEmoji(),size:"nano"===size?16:"micro"===size?24:20,variant:"color",embossed:!0})})]}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_OpenMoji__WEBPACK_IMPORTED_MODULE_6__.A,{emoji:getEmoji(),size:"nano"===size?16:"micro"===size?24:20,variant:"done"===step.status||"error"===step.status?"color":"black",embossed:!0}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{style:{fontSize:"nano"===size?"10px":"micro"===size?"11px":"12px",fontWeight:"active"===step.status||"next"===step.status?600:500,color:textColors[step.status],lineHeight:1,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:(()=>{const label=step.shortLabel||step.description;return"nano"===size?label.length>15?`${label.slice(0,15)}...`:label:"micro"===size?label.length>18?`${label.slice(0,18)}...`:label:label.length>25?`${label.slice(0,25)}...`:label})()})]}),"error"===step.status&&onRetry&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{style:{position:"absolute",inset:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"4px",backgroundColor:"rgba(0, 0, 0, 0.75)",backdropFilter:"blur(4px)"},children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{style:{fontSize:"18px",animation:"bounce 1s infinite"},children:"âš ï¸"}),("full"===size||"micro"===size)&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("button",{style:{fontSize:"9px",padding:"2px 8px",backgroundColor:"#dc322f",color:"white",borderRadius:"4px",border:"none",cursor:"pointer",fontWeight:500},onClick:e=>{e.stopPropagation(),onRetry()},children:"Retry"})]}),"active"===step.status&&void 0!==stepProgressPercent&&stepProgressPercent>0&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"2px",backgroundColor:"rgba(147, 161, 161, 0.3)",overflow:"hidden"},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{style:{height:"100%",backgroundColor:"#268bd2",width:`${stepProgressPercent}%`,transition:"width 0.3s ease-out"}})})]})]});var pos}const __WEBPACK_DEFAULT_EXPORT__=react__WEBPACK_IMPORTED_MODULE_2__.memo(function AsyncJobTimeline({jobName,steps,currentProgress,size="full",tab=!0,onClose,onDismiss,onStepClick,onRetryStep,className="",showProgressBar=!0,processingTimeMs,stepProgress,activeProgress=0,activeProgressPulse=!0}){var _steps_find;const shouldReduceMotion=(0,_hooks_useReducedMotion__WEBPACK_IMPORTED_MODULE_8__.I)(),[expandedStepId,setExpandedStepId]=(0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(null),[manualExpandId,setManualExpandId]=(0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(null),[forceCollapsed,setForceCollapsed]=(0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(!1),[expandedStepChildren,setExpandedStepChildren]=(0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(new Map),[loadingChildren,setLoadingChildren]=(0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(new Set),[decompositionJobs,setDecompositionJobs]=(0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(new Map);(0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{if(manualExpandId||forceCollapsed)forceCollapsed&&setExpandedStepId(null);else{const activeStep=steps.find(s=>"active"===s.status);setExpandedStepId((null==activeStep?void 0:activeStep.id)||null)}},[steps,manualExpandId,forceCollapsed]);const effectiveExpandedId=manualExpandId||expandedStepId,isComplete=currentProgress>=100;steps.every(s=>"done"===s.status);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{style:{backgroundColor:_lib_design_system__WEBPACK_IMPORTED_MODULE_7__.ZI.bg.tertiary,borderColor:_lib_design_system__WEBPACK_IMPORTED_MODULE_7__.ZI.border.default,boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1)"},className:styled_jsx_style__WEBPACK_IMPORTED_MODULE_1___default().dynamic([["78293984d1ffeedf",[shouldReduceMotion?"":"\n          :global(.emoji-blend-black) {\n            animation: emoji-show-black 4s ease-in-out infinite;\n          }\n\n          :global(.emoji-blend-color) {\n            animation: emoji-show-color 4s ease-in-out infinite;\n          }\n\n          :global(.active-progress-overlay) {\n            animation: shimmer-sweep 3s linear infinite;\n          }\n        "]]])+" "+`\n        border rounded overflow-visible\n        ${"nano"===size?"p-1":"p-2"}\n        ${"full"===size?"pt-12":"micro"===size?"pt-10":""}\n        ${className}\n      `,children:["nano"!==size&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:styled_jsx_style__WEBPACK_IMPORTED_MODULE_1___default().dynamic([["78293984d1ffeedf",[shouldReduceMotion?"":"\n          :global(.emoji-blend-black) {\n            animation: emoji-show-black 4s ease-in-out infinite;\n          }\n\n          :global(.emoji-blend-color) {\n            animation: emoji-show-color 4s ease-in-out infinite;\n          }\n\n          :global(.active-progress-overlay) {\n            animation: shimmer-sweep 3s linear infinite;\n          }\n        "]]])+" relative flex items-center justify-center mb-0.5 "+("micro"===size?"-mt-8":"-mt-10"),children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{style:{color:_lib_design_system__WEBPACK_IMPORTED_MODULE_7__.ZI.text.secondary},className:styled_jsx_style__WEBPACK_IMPORTED_MODULE_1___default().dynamic([["78293984d1ffeedf",[shouldReduceMotion?"":"\n          :global(.emoji-blend-black) {\n            animation: emoji-show-black 4s ease-in-out infinite;\n          }\n\n          :global(.emoji-blend-color) {\n            animation: emoji-show-color 4s ease-in-out infinite;\n          }\n\n          :global(.active-progress-overlay) {\n            animation: shimmer-sweep 3s linear infinite;\n          }\n        "]]])+" "+`line-clamp-1 w-full text-center mb-2 ${"micro"===size?"text-[9px]":"text-[10px]"} font-medium ${effectiveExpandedId?"opacity-0":""}`,children:jobName}),(onClose||onDismiss)&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("button",{onClick:onDismiss||onClose,style:{color:_lib_design_system__WEBPACK_IMPORTED_MODULE_7__.ZI.text.primary,transition:shouldReduceMotion?"none":"color 0.2s"},onMouseEnter:e=>e.currentTarget.style.color=_lib_design_system__WEBPACK_IMPORTED_MODULE_7__.ZI.text.secondary,onMouseLeave:e=>e.currentTarget.style.color=_lib_design_system__WEBPACK_IMPORTED_MODULE_7__.ZI.text.primary,"aria-label":onDismiss?"Dismiss":"Close",className:styled_jsx_style__WEBPACK_IMPORTED_MODULE_1___default().dynamic([["78293984d1ffeedf",[shouldReduceMotion?"":"\n          :global(.emoji-blend-black) {\n            animation: emoji-show-black 4s ease-in-out infinite;\n          }\n\n          :global(.emoji-blend-color) {\n            animation: emoji-show-color 4s ease-in-out infinite;\n          }\n\n          :global(.active-progress-overlay) {\n            animation: shimmer-sweep 3s linear infinite;\n          }\n        "]]])+" absolute right-0 flex-shrink-0",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_barrel_optimize_names_X_lucide_react__WEBPACK_IMPORTED_MODULE_3__.A,{size:"micro"===size?10:12})})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:styled_jsx_style__WEBPACK_IMPORTED_MODULE_1___default().dynamic([["78293984d1ffeedf",[shouldReduceMotion?"":"\n          :global(.emoji-blend-black) {\n            animation: emoji-show-black 4s ease-in-out infinite;\n          }\n\n          :global(.emoji-blend-color) {\n            animation: emoji-show-color 4s ease-in-out infinite;\n          }\n\n          :global(.active-progress-overlay) {\n            animation: shimmer-sweep 3s linear infinite;\n          }\n        "]]])+" relative overflow-visible",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{style:{gap:0},className:styled_jsx_style__WEBPACK_IMPORTED_MODULE_1___default().dynamic([["78293984d1ffeedf",[shouldReduceMotion?"":"\n          :global(.emoji-blend-black) {\n            animation: emoji-show-black 4s ease-in-out infinite;\n          }\n\n          :global(.emoji-blend-color) {\n            animation: emoji-show-color 4s ease-in-out infinite;\n          }\n\n          :global(.active-progress-overlay) {\n            animation: shimmer-sweep 3s linear infinite;\n          }\n        "]]])+" flex items-end overflow-visible",children:steps.map((step,index)=>{const hasNestedContent=effectiveExpandedId===step.id&&(decompositionJobs.has(step.id)||expandedStepChildren.has(step.id));return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(StepSection,{step,index,totalSteps:steps.length,isExpanded:effectiveExpandedId===step.id,size,tab,onClick:()=>(async stepId=>{const step=steps.find(s=>s.id===stepId),currentlyExpanded=(manualExpandId||expandedStepId)===stepId,isActiveStep="active"===(null==step?void 0:step.status);if(currentlyExpanded)return isActiveStep&&!manualExpandId?setForceCollapsed(!0):manualExpandId===stepId&&(setManualExpandId(null),setForceCollapsed(!1)),void(null==onStepClick||onStepClick(stepId));if(setForceCollapsed(!1),step&&!1===step.isLeaf&&step.decompositionState&&"atomic"!==step.decompositionState)if(expandedStepChildren.has(stepId)||"decomposed"!==step.decompositionState){if(!expandedStepChildren.has(stepId)&&"stub"===step.decompositionState){setLoadingChildren(prev=>new Set(prev).add(stepId));const decompositionSteps=[{id:"analyze",description:"Analyze step complexity",shortLabel:"Analyzing",estimatedMinutes:0,leafType:"DIGITAL",icon:"ðŸ”",status:"pending"},{id:"breakdown",description:"Break down into sub-steps",shortLabel:"Breaking down",estimatedMinutes:0,leafType:"DIGITAL",icon:"ðŸ§©",status:"pending"},{id:"generate",description:"Generate micro-steps",shortLabel:"Generating",estimatedMinutes:0,leafType:"DIGITAL",icon:"âœ¨",status:"pending"}];setDecompositionJobs(prev=>new Map(prev).set(stepId,{steps:decompositionSteps,progress:0}));let currentProgress=0;const progressInterval=setInterval(()=>{currentProgress+=2,currentProgress<=100&&setDecompositionJobs(prev=>{const job=prev.get(stepId);if(!job)return prev;const updatedSteps=job.steps.map((s,i)=>currentProgress>=33*(i+1)?{...s,status:"done"}:currentProgress>=33*i?{...s,status:"active"}:s);return new Map(prev).set(stepId,{steps:updatedSteps,progress:currentProgress})})},100);try{const API_URL="http://localhost:8000",response=await fetch(`${API_URL}/api/v1/micro-steps/${stepId}/decompose`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:"default-user"})}),data=await response.json();clearInterval(progressInterval),setDecompositionJobs(prev=>{const job=prev.get(stepId);return job?new Map(prev).set(stepId,{steps:job.steps.map(s=>({...s,status:"done"})),progress:100}):prev});const children=data.children.map(child=>({id:child.step_id,description:child.description,shortLabel:child.short_label,estimatedMinutes:child.estimated_minutes,leafType:child.leaf_type,icon:child.icon,status:"pending",tags:child.tags,parentStepId:child.parent_step_id,level:child.level,isLeaf:child.is_leaf,decompositionState:child.decomposition_state}));setTimeout(()=>{setExpandedStepChildren(prev=>new Map(prev).set(stepId,children)),setDecompositionJobs(prev=>{const next=new Map(prev);return next.delete(stepId),next})},500)}catch(error){console.error("Failed to decompose step:",error),clearInterval(progressInterval),setDecompositionJobs(prev=>{const next=new Map(prev);return next.delete(stepId),next})}finally{setLoadingChildren(prev=>{const next=new Set(prev);return next.delete(stepId),next})}}}else{setLoadingChildren(prev=>new Set(prev).add(stepId));try{const API_URL="http://localhost:8000",response=await fetch(`${API_URL}/api/v1/micro-steps/${stepId}/children`),children=(await response.json()).children.map(child=>({id:child.step_id,description:child.description,shortLabel:child.short_label,estimatedMinutes:child.estimated_minutes,leafType:child.leaf_type,icon:child.icon,status:child.status||"pending",tags:child.tags,parentStepId:child.parent_step_id,level:child.level,isLeaf:child.is_leaf,decompositionState:child.decomposition_state}));setExpandedStepChildren(prev=>new Map(prev).set(stepId,children))}catch(error){console.error("Failed to fetch children:",error)}finally{setLoadingChildren(prev=>{const next=new Set(prev);return next.delete(stepId),next})}}setManualExpandId(stepId),null==onStepClick||onStepClick(stepId)})(step.id),stepProgressPercent:null==stepProgress?void 0:stepProgress.get(step.id),onRetry:onRetryStep?()=>onRetryStep(step.id):void 0,effectiveExpandedId,loadingChildren,hasNestedContent,activeProgress:"active"===step.status?activeProgress:void 0,activeProgressPulse},step.id)})}),effectiveExpandedId&&(decompositionJobs.has(effectiveExpandedId)||expandedStepChildren.has(effectiveExpandedId))&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:styled_jsx_style__WEBPACK_IMPORTED_MODULE_1___default().dynamic([["78293984d1ffeedf",[shouldReduceMotion?"":"\n          :global(.emoji-blend-black) {\n            animation: emoji-show-black 4s ease-in-out infinite;\n          }\n\n          :global(.emoji-blend-color) {\n            animation: emoji-show-color 4s ease-in-out infinite;\n          }\n\n          :global(.active-progress-overlay) {\n            animation: shimmer-sweep 3s linear infinite;\n          }\n        "]]])+" mt-2 px-2 overflow-visible",children:decompositionJobs.has(effectiveExpandedId)?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(AsyncJobTimeline,{jobName:"Breaking down...",steps:decompositionJobs.get(effectiveExpandedId).steps,currentProgress:decompositionJobs.get(effectiveExpandedId).progress,size:"full"===size?"micro":"nano",showProgressBar:!1}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(AsyncJobTimeline,{jobName:`${(null===(_steps_find=steps.find(s=>s.id===effectiveExpandedId))||void 0===_steps_find?void 0:_steps_find.shortLabel)||"Step"} breakdown`,steps:expandedStepChildren.get(effectiveExpandedId),currentProgress:0,size:"full"===size?"micro":"nano",showProgressBar:!1})}),showProgressBar&&(isComplete?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_ProgressBar__WEBPACK_IMPORTED_MODULE_4__.A,{variant:"segmented",segments:[{percentage:steps.filter(s=>"DIGITAL"===s.leafType).length/steps.length*100,color:_lib_design_system__WEBPACK_IMPORTED_MODULE_7__.Tj.cyan,label:`${steps.filter(s=>"DIGITAL"===s.leafType).length} digital steps`},{percentage:steps.filter(s=>"HUMAN"===s.leafType).length/steps.length*100,color:_lib_design_system__WEBPACK_IMPORTED_MODULE_7__.Tj.violet,label:`${steps.filter(s=>"HUMAN"===s.leafType).length} human steps`}].filter(seg=>seg.percentage>0),size:"sm"}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_ProgressBar__WEBPACK_IMPORTED_MODULE_4__.A,{variant:"gradient",progress:currentProgress,size:"sm"}))]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(styled_jsx_style__WEBPACK_IMPORTED_MODULE_1___default(),{id:"78293984d1ffeedf",dynamic:[shouldReduceMotion?"":"\n          :global(.emoji-blend-black) {\n            animation: emoji-show-black 4s ease-in-out infinite;\n          }\n\n          :global(.emoji-blend-color) {\n            animation: emoji-show-color 4s ease-in-out infinite;\n          }\n\n          :global(.active-progress-overlay) {\n            animation: shimmer-sweep 3s linear infinite;\n          }\n        "],children:`@keyframes emoji-show-color{0%{opacity:0}12.5%{opacity:1}50%{opacity:1}62.5%{opacity:0}100%{opacity:0}}@keyframes emoji-show-black{0%{opacity:1}12.5%{opacity:0}50%{opacity:0}62.5%{opacity:1}100%{opacity:1}}@keyframes shimmer-sweep{0%{background-position:200%0}100%{background-position:-200%0}}${shouldReduceMotion?"":"\n          :global(.emoji-blend-black) {\n            animation: emoji-show-black 4s ease-in-out infinite;\n          }\n\n          :global(.emoji-blend-color) {\n            animation: emoji-show-color 4s ease-in-out infinite;\n          }\n\n          :global(.active-progress-overlay) {\n            animation: shimmer-sweep 3s linear infinite;\n          }\n        "}\n      `})]})})},"./src/components/shared/ProgressBar.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>ProgressBar});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/next@15.5.6_@babel+core@7.28.4_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/compiled/react/jsx-runtime.js"),_lib_design_system__WEBPACK_IMPORTED_MODULE_2__=(__webpack_require__("./node_modules/.pnpm/next@15.5.6_@babel+core@7.28.4_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/compiled/react/index.js"),__webpack_require__("./src/lib/design-system.ts")),_hooks_useReducedMotion__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/hooks/useReducedMotion.ts");const SIZE_CONFIG={sm:_lib_design_system__WEBPACK_IMPORTED_MODULE_2__.YK[1],md:_lib_design_system__WEBPACK_IMPORTED_MODULE_2__.YK[2],lg:_lib_design_system__WEBPACK_IMPORTED_MODULE_2__.YK[3]};function ProgressBar({progress=0,variant="gradient",segments=[],size="sm",animated=!0,className=""}){const shouldReduceMotion=(0,_hooks_useReducedMotion__WEBPACK_IMPORTED_MODULE_3__.I)(),isComplete=progress>=100,heightValue=SIZE_CONFIG[size];return"gradient"===variant?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:`w-full ${className}`,style:{height:heightValue,backgroundColor:_lib_design_system__WEBPACK_IMPORTED_MODULE_2__.ZI.bg.tertiary,borderRadius:_lib_design_system__WEBPACK_IMPORTED_MODULE_2__.Vq.pill,overflow:"hidden"},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{style:{height:"100%",borderRadius:_lib_design_system__WEBPACK_IMPORTED_MODULE_2__.Vq.pill,width:`${Math.min(progress,100)}%`,background:isComplete?_lib_design_system__WEBPACK_IMPORTED_MODULE_2__.Tj.green:(0,_lib_design_system__WEBPACK_IMPORTED_MODULE_2__.p8)(_lib_design_system__WEBPACK_IMPORTED_MODULE_2__.Tj.blue,_lib_design_system__WEBPACK_IMPORTED_MODULE_2__.Tj.cyan),transition:shouldReduceMotion||!animated?"none":`width ${_lib_design_system__WEBPACK_IMPORTED_MODULE_2__.p0.slow} ease-out`}})}):"segmented"===variant&&segments.length>0?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:`flex ${className}`,style:{gap:_lib_design_system__WEBPACK_IMPORTED_MODULE_2__.YK[1],height:heightValue,borderRadius:_lib_design_system__WEBPACK_IMPORTED_MODULE_2__.Vq.pill,overflow:"hidden"},children:segments.map((segment,index)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{style:{width:`${segment.percentage}%`,backgroundColor:segment.color,borderRadius:0===index||index===segments.length-1?_lib_design_system__WEBPACK_IMPORTED_MODULE_2__.Vq.pill:"0",transition:shouldReduceMotion||!animated?"none":`all ${_lib_design_system__WEBPACK_IMPORTED_MODULE_2__.p0.slow} ease-out`},title:segment.label,role:"progressbar","aria-label":segment.label,"aria-valuenow":segment.percentage,"aria-valuemin":0,"aria-valuemax":100},index))}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:`w-full ${className}`,style:{height:heightValue,backgroundColor:_lib_design_system__WEBPACK_IMPORTED_MODULE_2__.ZI.bg.tertiary,borderRadius:_lib_design_system__WEBPACK_IMPORTED_MODULE_2__.Vq.pill,overflow:"hidden"}})}try{ProgressBar.displayName="ProgressBar",ProgressBar.__docgenInfo={description:"",displayName:"ProgressBar",props:{progress:{defaultValue:{value:"0"},description:"",name:"progress",required:!1,type:{name:"number | undefined"}},variant:{defaultValue:{value:"gradient"},description:"",name:"variant",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"gradient"'},{value:'"segmented"'}]}},segments:{defaultValue:{value:"[]"},description:"",name:"segments",required:!1,type:{name:"ProgressBarSegment[] | undefined"}},size:{defaultValue:{value:"sm"},description:"",name:"size",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"sm"'},{value:'"lg"'},{value:'"md"'}]}},animated:{defaultValue:{value:"true"},description:"",name:"animated",required:!1,type:{name:"boolean | undefined"}},className:{defaultValue:{value:""},description:"",name:"className",required:!1,type:{name:"string | undefined"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/shared/ProgressBar.tsx#ProgressBar"]={docgenInfo:ProgressBar.__docgenInfo,name:"ProgressBar",path:"src/components/shared/ProgressBar.tsx#ProgressBar"})}catch(__react_docgen_typescript_loader_error){}},"./src/hooks/useReducedMotion.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{I:()=>useReducedMotion});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/.pnpm/next@15.5.6_@babel+core@7.28.4_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/compiled/react/index.js");function useReducedMotion(){const[shouldReduceMotion,setShouldReduceMotion]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1);return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{const mediaQuery=window.matchMedia("(prefers-reduced-motion: reduce)");setShouldReduceMotion(mediaQuery.matches);const handleChange=event=>{setShouldReduceMotion(event.matches)};return mediaQuery.addEventListener?(mediaQuery.addEventListener("change",handleChange),()=>mediaQuery.removeEventListener("change",handleChange)):mediaQuery.addListener?(mediaQuery.addListener(handleChange),()=>mediaQuery.removeListener(handleChange)):void 0},[]),shouldReduceMotion}},"./src/lib/design-system.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Eo:()=>shadows,J:()=>fontSize,K_:()=>lineHeight,PL:()=>coloredShadow,RK:()=>iconSize,Tj:()=>colors,Vq:()=>borderRadius,Wy:()=>fontWeight,YK:()=>spacing,ZI:()=>semanticColors,p0:()=>duration,p8:()=>createGradient,ps:()=>hoverColors});const spacing={0:"0px",1:"4px",2:"8px",3:"12px",4:"16px",5:"20px",6:"24px",7:"28px",8:"32px",9:"36px",10:"40px",12:"48px",14:"56px",16:"64px",20:"80px",24:"96px",28:"112px",32:"128px"},fontSize={xs:"12px",sm:"14px",base:"16px",lg:"20px",xl:"24px","2xl":"28px","3xl":"32px","4xl":"36px"},lineHeight={tight:1.2,normal:1.5,relaxed:1.75},fontWeight={light:300,regular:400,medium:500,semibold:600,bold:700},borderRadius={none:"0px",sm:"4px",base:"8px",lg:"12px",xl:"16px","2xl":"24px","3xl":"32px",pill:"9999px",full:"9999px"},iconSize={xs:12,sm:16,base:20,lg:24,xl:28,"2xl":32},colors={base03:"#002b36",base02:"#073642",base01:"#586e75",base00:"#657b83",base0:"#839496",base1:"#93a1a1",base2:"#eee8d5",base3:"#fdf6e3",yellow:"#b58900",orange:"#cb4b16",red:"#dc322f",magenta:"#d33682",violet:"#6c71c4",blue:"#268bd2",cyan:"#2aa198",green:"#859900"},semanticColors={bg:{primary:colors.base03,secondary:colors.base02,tertiary:colors.base01},text:{primary:colors.base1,secondary:colors.base01,muted:colors.base01,inverse:colors.base03},border:{default:colors.base01,focus:colors.blue,accent:colors.cyan},accent:{primary:colors.cyan,secondary:colors.blue,success:colors.green,warning:colors.yellow,error:colors.red}},shadows={none:"none",sm:"0 1px 2px 0 rgba(0, 0, 0, 0.05)",base:"0 1px 3px 0 rgba(0, 0, 0, 0.1)",md:"0 4px 6px -1px rgba(0, 0, 0, 0.1)",lg:"0 10px 15px -3px rgba(0, 0, 0, 0.1)",xl:"0 20px 25px -5px rgba(0, 0, 0, 0.1)"},coloredShadow=(color,opacity="40")=>`0 2px 8px ${color}${opacity}`,duration={instant:"0ms",fast:"150ms",normal:"300ms",slow:"500ms",slower:"1000ms",slowest:"1500ms",pause:"2000ms"},hoverColors={cyan:"#35b5ac",blue:"#3a9ee5",green:"#96aa00",yellow:"#cb9b00",red:"#e64747",orange:"#d65b2a",magenta:"#dc5694",violet:"#8589d4",base02:"#0a4553"};function createGradient(baseColor,lighterColor){return`linear-gradient(180deg, ${lighterColor} 0%, ${baseColor} 100%)`}createGradient(colors.blue,hoverColors.blue),createGradient(colors.green,hoverColors.green),createGradient(colors.red,hoverColors.red),createGradient(colors.yellow,hoverColors.yellow),createGradient(colors.cyan,hoverColors.cyan)}}]);