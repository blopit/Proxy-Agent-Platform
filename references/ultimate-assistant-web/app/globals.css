@tailwind base;
@tailwind components;
@tailwind utilities;

/* CSS Variables */
:root {
  --header-height: 76px;
  --content-max-width: 28rem;
  --glass-blur: 12px;
}

/* Base Styles */
html, body {
  @apply h-full antialiased overflow-x-hidden;
  -webkit-tap-highlight-color: transparent;
}

body {
  @apply bg-background text-foreground;
  overscroll-behavior-y: none;
}

/* Animations */
@keyframes gradient {
  0% { opacity: 0.97; }
  50% { opacity: 1; }
  100% { opacity: 0.97; }
}

.animate-gradient {
  background-size: 100% 100%; /* Changed from 200% 200% */
  animation: gradient 4s ease infinite;
}

/* Glass Effects */
@layer components {
  .glass-header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 50;
    backdrop-filter: blur(12px);
    background-color: rgba(255, 255, 255, 0.5);
    border-bottom: 1px solid rgba(226, 232, 240, 0.2);
    transition: all 0.3s ease;
    padding: 0;
  }

  .glass-content {
    @apply backdrop-blur-sm bg-white/40 dark:bg-slate-900/40;
    @apply shadow-xl shadow-slate-200/10 dark:shadow-slate-900/20;
    @apply transition-colors duration-300;
  }

  .tab-container {
    @apply overflow-x-auto;
    @apply scrollbar-hide;
    -webkit-overflow-scrolling: touch;
  }
}

/* Utility Classes */
@layer utilities {
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
  
  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }

  /* iOS height fix */
  @supports (-webkit-touch-callout: none) {
    .min-h-screen {
      min-height: -webkit-fill-available;
    }
  }
}

/* Dark Mode Adjustments */
@media (prefers-color-scheme: dark) {
  .glass-header {
    background-color: rgba(15, 23, 42, 0.5);
    border-bottom-color: rgba(51, 65, 85, 0.2);
  }

  .glass-content {
    @apply bg-slate-900/40;
  }
}

@layer base {
  :root {
    --background: 222.2 84% 4.9%;
    --foreground: 210 40% 98%;
    --card: 222.2 84% 4.9%;
    --card-foreground: 210 40% 98%;
    --popover: 222.2 84% 4.9%;
    --popover-foreground: 210 40% 98%;
    --primary: 210 40% 98%;
    --primary-foreground: 222.2 47.4% 11.2%;
    --secondary: 217.2 32.6% 17.5%;
    --secondary-foreground: 210 40% 98%;
    --muted: 217.2 32.6% 17.5%;
    --muted-foreground: 215 20.2% 65.1%;
    --accent: 217.2 32.6% 17.5%;
    --accent-foreground: 210 40% 98%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 210 40% 98%;
    --border: 217.2 32.6% 17.5%;
    --input: 217.2 32.6% 17.5%;
    --ring: 212.7 26.8% 83.9%;
    --radius: 0.5rem;
  }
}

@layer base {
  * {
    @apply border-[color:hsl(var(--border))];
  }
  body {
    @apply bg-background text-foreground;
  }
}

@keyframes gradientShift {
  0% {
    background-position: 25% 25%;  /* Adjusted to stay more centered */
  }
  50% {
    background-position: 75% 75%;
  }
  100% {
    background-position: 25% 25%;
  }
}

/* More subtle background animation */
@keyframes subtleShift {
  0% {
    background-position: 0% 0%;
  }
  25% {
    background-position: 25% 5%;
  }
  50% {
    background-position: 50% 0%;
  }
  75% {
    background-position: 25% -5%;
  }
  100% {
    background-position: 0% 0%;
  }
}

/* Enhanced animations */
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(-8px) scale(0.98);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

@keyframes scaleIn {
  from {
    opacity: 0;
    transform: scale(0.95);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

@keyframes slideInRight {
  from {
    opacity: 0;
    transform: translateX(-8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes dialogZoomOut {
  from {
    opacity: 0.4;
    transform: scale(0.95) translateY(-8px);
  }
  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

@keyframes pulse {
  0% {
    opacity: 0.5;
    transform: scale(0.98);
  }
  50% {
    opacity: 1;
    transform: scale(1.02);
  }
  100% {
    opacity: 0.5;
    transform: scale(0.98);
  }
}

/* Animation utilities */
.animate-fadeIn {
  animation: fadeIn var(--duration-normal) var(--ease-gentle) forwards;
}

.animate-scaleIn {
  animation: scaleIn var(--duration-normal) var(--ease-bounce) forwards;
}

.animate-slideInRight {
  animation: slideInRight var(--duration-normal) var(--ease-smooth) forwards;
}

.animate-pulse-gentle {
  animation: pulse 2s var(--ease-gentle) infinite;
}

.animate-dialogZoomOut {
  animation: dialogZoomOut 0.5s var(--ease-out-in) forwards;
}

/* Transition utilities */
.transition-gentle {
  transition-timing-function: var(--ease-gentle);
}

.transition-bounce {
  transition-timing-function: var(--ease-bounce);
}

.transition-smooth {
  transition-timing-function: var(--ease-smooth);
}

.transition-out-in {
  transition-timing-function: var(--ease-out-in);
}

/* Scrollbar styling */
.scrollbar-none {
  scrollbar-width: none;
  -ms-overflow-style: none;
}

.scrollbar-none::-webkit-scrollbar {
  display: none;
}

/* Hide scrollbar but allow scrolling */
.scrollbar-hide {
  -ms-overflow-style: none;
  scrollbar-width: none;
}
.scrollbar-hide::-webkit-scrollbar {
  display: none;
}

/* Improve touch handling */
.touch-pan-y {
  touch-action: pan-y;
  -webkit-overflow-scrolling: touch;
}

/* Prevent rubber-banding on iOS */
@supports (-webkit-touch-callout: none) {
  .min-h-screen {
    min-height: -webkit-fill-available;
  }
}

@layer utilities {
  /* Glass effect utilities */
  .glass-effect {
    @apply backdrop-blur-[8px] bg-white/85 dark:bg-slate-900/85;
    @apply shadow-lg shadow-indigo-500/10 dark:shadow-indigo-900/20;
    @apply border border-indigo-200/30 dark:border-indigo-900/30;
  }

  .glass-effect-sm {
    @apply backdrop-blur-[8px] bg-white/85 dark:bg-slate-900/85;
    @apply shadow-md shadow-indigo-500/5 dark:shadow-indigo-900/10;
    @apply border border-indigo-200/20 dark:border-indigo-900/20;
  }

  .glass-effect-xl {
    @apply backdrop-blur-[8px] bg-white/85 dark:bg-slate-900/85;
    @apply shadow-xl shadow-indigo-500/20 dark:shadow-indigo-900/30;
    @apply border border-indigo-200/40 dark:border-indigo-900/40;
  }

  /* Hide overlays on mobile */
  @media (max-width: 768px) {
    .overlay-hidden-mobile {
      display: none !important;
    }
  }

  @keyframes portalGlow {
    0%, 100% { filter: brightness(1) blur(8px); }
    50% { filter: brightness(1.2) blur(12px); }
  }

  .portal-active-glow {
    @apply relative;
  }

  .portal-active-glow::after {
    content: '';
    @apply absolute inset-0;
    @apply rounded-[inherit] opacity-0;
    @apply transition-opacity duration-300;
    box-shadow: 0 0 40px 5px rgba(var(--portal-glow-color, 255, 255, 255), 0.4);
    animation: portalGlow 3s ease-in-out infinite;
  }

  .portal-active-glow.active::after {
    @apply opacity-100;
  }
}

@layer components {
  /* Add these new styles */
  .tab-navigation-button {
    @apply relative transition-all duration-200 ease-smooth;
  }

  .tab-navigation-button::after {
    content: '';
    @apply absolute bottom-0 left-0 right-0 h-0.5 transform scale-x-0 transition-transform duration-200 ease-smooth;
  }

  .tab-navigation-button:hover::after {
    @apply scale-x-100;
  }

  .tab-navigation-button[data-state="active"]::after {
    @apply scale-x-100;
  }
}

/* Portal Card Effects */
.portal-card-base {
  /* Base styles for portal cards */
  @apply overflow-hidden relative;
  transform-style: preserve-3d;
  /* Add base shadow for the card itself */
  box-shadow: 0 10px 30px -5px rgba(0, 0, 0, 0.1);
}

.portal-content {
  /* Content container for portal cards */
  @apply overflow-hidden;
  transform-style: preserve-3d;
}

.portal-layers {
  /* Layer container for portal content */
  @apply overflow-hidden;
  clip-path: inset(0);
  -webkit-clip-path: inset(0);
  /* Add subtle gradient overlay for depth */
  background: linear-gradient(
    180deg,
    rgba(255, 255, 255, 0.02) 0%,
    rgba(0, 0, 0, 0.05) 100%
  );
}

/* Custom 3D transformations */
.transform-style-preserve-3d {
  transform-style: preserve-3d;
  -webkit-transform-style: preserve-3d;
}

/* Layer inset mode */
.layer-inset {
  @apply overflow-clip;
  transform-style: preserve-3d;
  /* Remove inner shadow that's causing the weird border */
  /* box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.1); */
}

/* Mobile-specific 3D layer handling */
.mobile-3d-layer {
  -webkit-backface-visibility: hidden;
  backface-visibility: hidden;
}

/* Portal mask effect */
.portal-card-mask {
  @apply overflow-hidden;
  /* Optional circular mask */
  border-radius: inherit;
  /* Lighter shadow to avoid weird border */
  box-shadow: inset 0 5px 15px rgba(0, 0, 0, 0.08);
}

/* Dark mode adjustments for portal effects */
.dark .portal-card-base {
  box-shadow: 0 10px 30px -5px rgba(0, 0, 0, 0.3);
}

.dark .portal-layers {
  background: linear-gradient(
    180deg,
    rgba(255, 255, 255, 0.05) 0%,
    rgba(0, 0, 0, 0.15) 100%
  );
}

.dark .layer-inset {
  /* Remove inner shadow that's causing the weird border */
  /* box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.2); */
}

.dark .portal-card-mask {
  box-shadow: inset 0 5px 15px rgba(0, 0, 0, 0.3);
}

@keyframes iconGlow {
  0%, 100% { 
    filter: brightness(1) drop-shadow(0 0 5px rgba(255, 255, 255, 0.5));
  }
  50% { 
    filter: brightness(1.5) drop-shadow(0 0 10px rgba(255, 255, 255, 0.8));
  }
}

.portal-icon-glow {
  animation: iconGlow 2s ease-in-out infinite;
}

/* Touch scrolling styles */
.touch-none {
  touch-action: none;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  user-select: none;
}

.touch-pan-y {
  touch-action: pan-y;
  -webkit-overflow-scrolling: touch;
}

/* Smooth scrolling */
.will-change-transform {
  will-change: transform;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  transform: translateZ(0);
  -webkit-transform: translateZ(0);
}

/* Main content container */
main {
  position: relative;
  width: 100%;
  height: 100%;
  overflow-x: hidden;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
}

/* Prevent bounce effect on iOS but allow normal scrolling */
html, body {
  width: 100%;
  height: 100%;
  overflow-x: hidden;
  overflow-y: auto;
  overscroll-behavior-y: none;
  -webkit-overflow-scrolling: touch;
}

/* Add CSS to handle scroll-margin-top for sections */
section {
  scroll-margin-top: var(--header-height);
  position: relative;
}

/* Add CSS for sticky headers that only stick when they're at the top */
@supports (position: sticky) {
  .section-header-sticky {
    position: sticky;
    top: 12px; /* don't change this*/
    z-index: 10;
    backdrop-filter: blur(12px);
    background-color: rgba(255, 255, 255, 0.5);
    border-bottom: 1px solid rgba(226, 232, 240, 0.2);
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
    width: 100%;
    left: 0;
    right: 0;
    transition: all 0.3s ease;
  }
}

/* Dark Mode Adjustments for section headers */
@media (prefers-color-scheme: dark) {
  .section-header-sticky {
    background-color: rgba(15, 23, 42, 0.5);
    border-bottom-color: rgba(51, 65, 85, 0.2);
  }
}

